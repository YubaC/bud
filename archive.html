<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home | Bone Age Evaluation</title>

    <!-- Bootstrap5 -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/js/bootstrap.bundle.min.js"></script>

    <!-- FontAwesome5 -->
    <link rel="stylesheet" href="./lib/fontawesome-free-5.15.4-web/css/all.min.css">

    <link rel="stylesheet" href="./css/utils.css">
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/note-paper.css">
    <link rel="stylesheet" href="./css/board-clips.css">
    <link rel="stylesheet" href="./css/archive-card.css">
    <!-- <link rel="stylesheet" href="./css/index.css"> -->

    <script src="https://cdn.staticfile.org/jquery/2.1.4/jquery.min.js"></script>
    <script src="./lib/jquery.transform.js-master/jquery.transform2d.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>

    <script type="module" src="./lib/relative-time-element-4.3.0/dist/bundle.min.js"></script>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-sm border-bottom fixed-top">
            <a href="#main-content" class="skip-to-main-content btn btn-danger">
                Skip to main content
            </a>

            <a class="navbar-brand ms-3" href="/"><img src="./images/icon.png" alt="BUD Logo"></a>
            <!-- Links -->
            <ul class="navbar-nav d-flex me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="home.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="index.html">Introduce</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="upload.html">Upload</a>
                </li>
            </ul>

            <ul class="navbar-nav d-flex align-items-center">
                <li class="nav-item mx-1">
                    <a class="btn rounded-pill px-4" href="#">Sign up</a>
                </li>
                <li class="nav-item ms-1 me-4">
                    <a class="btn btn-outline-success rounded-pill px-4" href="login.html">Sign in</a>
                </li>
            </ul>
        </nav>
    </header>

    <style>
        .layout-sidebar {
            max-width: 330px;
            /* height: 100vh; */
            /* background-color: #f8f9fa; */
            /* position: fixed; */
            /* top: 0; */
            /* left: 0; */
        }

        .kid-avatar img {
            aspect-ratio: 1/1;
            width: 85%;
            margin-top: 20px;
            margin-right: auto;
            margin-left: auto;
            /* height: 100%; */
            display: flex;
            justify-content: center;
            align-items: center;
            /* border: 2px solid #ced4da; */
            border-radius: 50%;
        }

        .kid-info {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 300;
        }

        .kid-info p {
            font-size: 1.2rem;
            margin-bottom: .4rem;
        }

        .layout-main {
            /* background-color: transparent; */
            /* height: 100vh; */
            width: 100%;
            background-color: transparent;
        }

        .base-plate {
            /* width: calc(100vw - 600px); */
            margin-top: 40px;
        }

        .a4-paper {
            width: calc(100vw - 650px);
            height: auto;
            padding: 9.4% 15%;
        }

        .paper-nav {
            position: absolute;
            top: 70px;
            transition: all 300ms;
            user-select: none;
        }

        .paper-nav-left {
            left: -90px;
        }

        .paper-nav-right {
            left: calc(100% - 95px);
        }

        .paper-nav-item {
            color: #000;
            font-weight: 600;
            text-decoration: none;
            width: 170px;
            margin-bottom: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            transform: translateX(0px);
        }

        /* .paper-nav-left .paper-nav-item.paper-nav-item.moving {
            transition: all 300ms ease-in-out;
        } */

        .paper-nav-item.moveout {
            transform: translateX(160px);
        }

        .paper-nav-item.disabled {
            color: #6c757d;
            background-color: #fff;
            border: 1px solid #dee2e6;
        }

        .paper-nav-item:hover {
            color: #000;
            filter: brightness(0.9);
        }

        .paper-nav-item.disabled:hover {
            color: #6c757d;
            filter: brightness(1);
            cursor: not-allowed;
        }

        .paper-nav-left .paper-nav-item {
            padding: 10px 40px 10px 15px;
            transition: transform 150ms;
        }

        .paper-nav-right .paper-nav-item {
            padding: 10px 15px 10px 40px;
            transition: all 300ms;
        }

        .paper-nav-left .paper-nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            right: 10px;
            width: 10px;
            height: 100%;
            background-color: rgb(183, 0, 0);
        }

        .paper-nav-right .paper-nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 12px;
            width: 10px;
            height: 100%;
            background-color: rgb(183, 0, 0);
        }

        .paper-nav-left .paper-nav-item.active {
            transform: translateX(-20px);
        }

        .paper-nav-right .paper-nav-item.active {
            transform: translateX(20px);
        }

        :root {
            --paper-nav-bg-1: #d1e7dd;
            --paper-nav-border-1: #badbcc;
            --paper-nav-bg-2: #cff4fc;
            --paper-nav-border-2: #b6effb;
            --paper-nav-bg-3: #fff3cd;
            --paper-nav-border-3: #ffbf00;
            /* --paper-nav-border-3: #ffecb5; */
            --paper-nav-bg-4: #f8d7da;
            --paper-nav-border-4: #f5c2c7;
            --paper-nav-bg-5: #cfe2ff;
            --paper-nav-border-5: #b6d4fe;
        }

        .paper-nav-item:nth-child(5n+1) {
            background-color: var(--paper-nav-bg-1);
            border: 1px solid var(--paper-nav-border-1);
        }

        .paper-nav-item:nth-child(5n+2) {
            background-color: var(--paper-nav-bg-2);
            border: 1px solid var(--paper-nav-border-2);
        }

        .paper-nav-item:nth-child(5n+3) {
            background-color: var(--paper-nav-bg-3);
            border: 1px solid var(--paper-nav-border-3);
        }

        .paper-nav-item:nth-child(5n+4) {
            background-color: var(--paper-nav-bg-4);
            border: 1px solid var(--paper-nav-border-4);
        }

        .paper-nav-item:nth-child(5n) {
            background-color: var(--paper-nav-bg-5);
            border: 1px solid var(--paper-nav-border-5);
        }

        /* .a4-paper {
            width: 100%;
            height: auto;0
        } */
        .archive-card {
            width: 41.666667%;
            margin-top: 20px;
            margin-right: auto;
        }
    </style>

    <main id="main-content" class="container-fluid d-flex">
        <div class="layout-sidebar p-4">
            <div class="single-sticky-note position-relative p-2">
                <div class="ribbon"></div>
                <div class="kid-avatar">
                    <img src="./images/happy-kid.png" alt="A happy kid.">
                </div>
                <div class="kid-info">
                    <div class="ms-2 p-4">
                        <h3 class="mt-4">A happy kid</h3>
                        <p class="mt-4"><i class="fa fa-map-marker-alt me-2" aria-hidden="true"></i>The Foggy City</p>
                        <p><i class="fas fa-birthday-cake me-2" aria-hidden="true"></i>Age: 6</p>
                    </div>
                </div>
            </div>

            <!-- <div id="kid-chart" class="mt-4"></div> -->
        </div>

        <div class="layout-main me-4">
            <div class="base-plate">
                <nav id="tool-bar" class="paper-nav paper-nav-left nav flex-column">
                    <button id="paper-previous" class="paper-nav-item text-start disabled">
                        <i class="fas fa-angle-left fa-fw me-2" aria-hidden="true"></i>
                        <span>Previous</span>
                    </button>
                    <button id="paper-jumpto" class="paper-nav-item text-start">
                        <span>Jump to page</span>
                        <input type="number" class="form-control mt-1" id="age" min="0" max="18" required>
                    </button>
                    <button id="paper-next" class="paper-nav-item text-start">
                        <span>Next</span>
                        <i class="fas fa-angle-right fa-fw ms-2" aria-hidden="true"></i>
                    </button>
                    <button id="paper-save" class="paper-nav-item text-start">
                        <i class="fas fa-download fa-fw me-2" aria-hidden="true"></i>
                        <span>Save</span>
                    </button>
                    <button id="paper-print" class="paper-nav-item text-start">
                        <i class="fas fa-print fa-fw me-2" aria-hidden="true"></i>
                        <span>Print</span>
                    </button>
                    <button id="paper-email" class="paper-nav-item text-start">
                        <i class="fas fa-mail-bulk fa-fw me-2" aria-hidden="true"></i>
                        <span>Email</span>
                    </button>
                </nav>
                <style>
                    .fade * {
                        transition: opacity .15s linear;
                    }
                </style>

                <script>
                    const texts = [
                        `[Page 1] Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras ultrices tempus aliquam. Vestibulum vehicula massa ex, ut mattis sem volutpat nec. Donec malesuada volutpat molestie. Proin id velit arcu. Phasellus accumsan consectetur libero non vestibulum. Donec sollicitudin, lacus pulvinar pharetra molestie, quam sapien pretium sem, in sodales diam mi id odio. Sed tincidunt augue vel quam venenatis posuere. Nam sodales diam ornare maximus venenatis. Aliquam condimentum justo sit amet consequat malesuada. Nulla volutpat dui a arcu elementum hendrerit. Nunc egestas elementum ipsum, ut laoreet nibh condimentum id. Praesent nec dolor sagittis, consectetur sem in, pharetra leo. Vestibulum odio urna, luctus nec elit eu, rhoncus rutrum libero.

Proin sit amet mi nec velit scelerisque rhoncus quis sit amet tortor. Maecenas sagittis tortor in feugiat pulvinar. Nullam id venenatis nunc. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed sit amet velit eu sem rhoncus volutpat. Vestibulum condimentum erat vulputate semper aliquet. Morbi ullamcorper vel arcu eget consectetur. Fusce eget luctus velit.

Aliquam quis aliquet enim. Sed at consequat sem, in venenatis diam. Morbi libero turpis, rutrum euismod mi ac, commodo pretium mauris. Mauris sit amet hendrerit mi, in ultricies arcu. Ut quis est lorem. Vivamus sit amet est lobortis, efficitur sapien vitae, facilisis mi. Sed ante augue, volutpat eu felis a, finibus auctor libero. `,
                        `[Page 2] Quisque sed orci libero. Quisque tortor nunc, hendrerit at ante vel, vehicula rhoncus quam. Suspendisse ultricies vel leo rhoncus fermentum. Cras fringilla feugiat metus eu tristique. Curabitur faucibus leo vitae elit dapibus, et rhoncus lorem dictum. Nulla faucibus hendrerit ipsum in commodo. Pellentesque facilisis consectetur magna ac gravida. Fusce tristique mi sapien, vel pretium urna sollicitudin non. Cras sed ullamcorper est. Sed et diam ipsum. Nullam vestibulum vulputate tincidunt.

Morbi laoreet lacinia tellus, id blandit ipsum porta eget. Ut tincidunt et mi sit amet porttitor. Nullam non felis nisl. Phasellus maximus est vel ornare faucibus. Proin id est ac nibh pharetra porttitor porttitor nec ipsum. Maecenas nunc libero, interdum ut ligula sed, pulvinar vestibulum risus. Quisque elit dui, suscipit vitae auctor vel, congue non sem. Interdum et malesuada fames ac ante ipsum primis in faucibus. Aenean a risus dui. Vivamus sagittis orci vel justo commodo commodo. Donec gravida enim in mauris tempor, sit amet mollis augue dapibus. Donec blandit odio vitae lectus volutpat ullamcorper. Phasellus congue nec mauris eu semper. Morbi egestas euismod risus, ac mollis enim posuere et.

Suspendisse iaculis facilisis molestie. Mauris in massa nec felis iaculis feugiat in vitae sem. Vivamus non dictum neque, quis aliquam risus. Ut lobortis quam et facilisis aliquam. Praesent tempus quis dui ac dapibus. Vestibulum dapibus sem velit, ornare facilisis augue posuere eleifend. Aliquam erat volutpat. Nulla sed suscipit sapien. In convallis pretium volutpat. Aenean vel iaculis risus. Etiam at nisl turpis. Pellentesque eu nisl eu arcu sodales ultricies non nec nisl. Fusce a tortor vel purus posuere hendrerit vitae et nibh. `,
                        `[Page 3] Donec cursus justo ut interdum mattis. Praesent vestibulum velit vel tortor feugiat interdum. Integer id viverra orci. Suspendisse maximus gravida elit. Nam in nisi rutrum tortor porta viverra. Cras pharetra sagittis dui, vel tincidunt mi interdum nec. Pellentesque molestie nisl porta commodo efficitur. Morbi et nunc a elit ultricies aliquet a rhoncus dolor. Phasellus sit amet mi massa. Integer maximus enim id scelerisque sollicitudin.

Phasellus mattis, leo quis egestas tempor, eros enim venenatis elit, sit amet maximus tellus massa egestas dolor. Nullam suscipit sapien vitae sem finibus tincidunt. Mauris at orci erat. Sed at finibus purus. Nam porta imperdiet magna, egestas auctor augue faucibus id. Ut eu ex laoreet, aliquet lorem in, tincidunt sapien. In et posuere nisi. Etiam porttitor turpis diam, sit amet suscipit nibh dignissim id. Vestibulum ultricies, erat vel lacinia malesuada, felis ante mattis lectus, sed aliquam sem sem ut turpis. Mauris vitae dolor condimentum, efficitur ipsum at, gravida est.

Donec in nulla maximus, fermentum ex rutrum, accumsan eros. Vestibulum tincidunt dignissim libero, ac auctor libero dignissim vel. Suspendisse id lobortis urna, sed hendrerit turpis. Phasellus quis mattis lorem, quis blandit odio. Vivamus mauris mi, lacinia ac eros ac, maximus tincidunt enim. Praesent eu accumsan enim. Maecenas venenatis ante leo, vitae sodales metus porta eget. Pellentesque diam purus, semper eget pellentesque ac, elementum et urna. Phasellus elementum luctus tortor, a scelerisque est. `,
                        `[Page 4] Suspendisse nec ipsum lacus. Nullam at cursus odio. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Integer porttitor metus non viverra rutrum. Vestibulum a dui ac turpis eleifend mollis. Mauris mattis mauris viverra tristique pharetra. Donec congue, ligula sit amet fermentum consequat, sem massa faucibus sem, in feugiat libero nisi non nibh. Ut neque orci, dapibus ac mi sed, maximus pulvinar nisl. Praesent posuere neque nec mauris volutpat lobortis. Nullam interdum orci sit amet fringilla vehicula. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce felis sapien, ultrices a sagittis nec, blandit sit amet nunc. In nec porta arcu. Cras cursus, ex in hendrerit pulvinar, sapien leo vestibulum felis, consequat tincidunt nisi lectus id velit.

Nullam dui dolor, efficitur in felis sit amet, gravida feugiat urna. Suspendisse ultrices nisl ac neque sagittis vulputate. Nunc ut sollicitudin nisi, ac varius quam. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Nullam purus eros, pulvinar at luctus et, dapibus at eros. Nulla commodo ex massa, euismod vulputate lorem tempor sit amet. Nam tincidunt in nisl sit amet vehicula.

Nunc non porttitor elit, ut commodo nisi. Suspendisse erat urna, sagittis in purus vitae, ultrices tempus eros. Donec tincidunt orci a viverra posuere. Maecenas et ultrices ligula, eu tempor elit. Suspendisse porta tellus non ante sollicitudin, ac suscipit mi auctor. Quisque vel orci erat. Nullam eu viverra justo. In sit amet faucibus mi. Donec vestibulum, magna eu gravida gravida, elit diam mattis odio, nec convallis lorem lorem sit amet quam. `,
                        `[Page 5] Aliquam posuere dui volutpat metus vehicula, aliquet tincidunt ex elementum. Mauris cursus nisl eget consequat egestas. Maecenas dictum auctor ultrices. Etiam quis eros varius nibh posuere accumsan. Integer consequat sem ac ipsum porta, nec cursus purus sollicitudin. Duis vel neque vehicula, condimentum tortor eu, ultricies orci. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec pulvinar ac lacus quis congue. Phasellus a nisi at massa placerat aliquam.

Morbi quis interdum mauris, ut mollis libero. Proin ac condimentum leo. Nam at odio sit amet massa aliquet imperdiet. Pellentesque nunc erat, semper vel ex vel, porta convallis felis. Nam sed metus at lacus consequat ultricies. Ut vitae metus gravida quam rhoncus auctor a eget felis. Curabitur at urna a ante ullamcorper aliquet et sed ex. Interdum et malesuada fames ac ante ipsum primis in faucibus.

Pellentesque ornare semper arcu, ac luctus dui ornare vel. Maecenas turpis lacus, commodo at facilisis quis, fermentum in lectus. Etiam vel euismod odio, dictum ullamcorper felis. Donec ut tempor lorem, vitae dapibus nibh. Vivamus ullamcorper auctor turpis sed dapibus. Phasellus et velit vel purus pulvinar dapibus. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Phasellus egestas facilisis ipsum in hendrerit. Donec eget pharetra felis, eu fermentum risus. Pellentesque lacinia ut velit nec suscipit. Aliquam erat volutpat. Aliquam sollicitudin fermentum pellentesque. Aliquam ultrices eros ligula, et aliquet ex auctor eleifend. Suspendisse molestie ligula sed tincidunt viverra. Donec tempus magna sem, non feugiat arcu vestibulum sed. Nam aliquam ut turpis eget pulvinar. `,
                    ]

                    const charts = [`<div id="kid-chart" class="mt-4"></div>`];

                    const results = [
                        `<div class="row mx-auto w-100">
                            <a href="./archive.html" class="archive-card card col-md-5 mx-auto shadow-sm">
                                <img src="./images/bone-hand.jpg" alt="" class="w-100">
                                <div class="name"><relative-time datetime="2024-01-04T15:02:18.000Z"
                                        tense="past"></relative-time>
                                </div>
                            </a>
                            <a href="./archive.html" class="archive-card card col-md-5 mx-auto shadow-sm">
                                <img src="./images/bone-hand.jpg" alt="" class="w-100">
                                <div class="name"><relative-time datetime="2022-06-28T17:09:18.000Z"
                                        tense="past"></relative-time>
                                </div>
                            </a>
                            <a href="./archive.html" class="archive-card card col-md-5 mx-auto shadow-sm">
                                <img src="./images/bone-hand.jpg" alt="" class="w-100">
                                <div class="name"><relative-time datetime="2022-06-28T17:09:18.000Z"
                                        tense="past"></relative-time>
                                </div>
                            </a>
                            <a href="./archive.html" class="archive-card card col-md-5 mx-auto shadow-sm">
                                <img src="./images/bone-hand.jpg" alt="" class="w-100">
                                <div class="name"><relative-time datetime="2022-06-28T17:09:18.000Z"
                                        tense="past"></relative-time>
                                </div>
                            </a>
                        </div>`,
                        `<div class="row mx-auto w-100">
                            <a href="./archive.html" class="archive-card card col-md-5 mx-auto shadow-sm">
                                <img src="./images/bone-hand.jpg" alt="" class="w-100">
                                <div class="name"><relative-time datetime="2022-05-01T13:07:13.000Z"
                                        tense="past"></relative-time>
                                </div>
                            </a>
                            <a href="./archive.html" class="archive-card card col-md-5 mx-auto shadow-sm">
                                <img src="./images/bone-hand.jpg" alt="" class="w-100">
                                <div class="name"><relative-time datetime="2021-09-30T09:31:52.000Z"
                                        tense="past"></relative-time>
                                </div>
                            </a>
                            <a href="/" class="archive-card card col-md-5 empty"></a>
                            <div class="col-md-5 mx-auto"></div>
                        </div>`,
                    ];
                </script>

                <nav id="section-bar" class="paper-nav paper-nav-right nav flex-column">
                    <a href="#paper-report" class="paper-nav-item active" data-bs-toggle="tab">
                        <i class="fas fa-clipboard-check fa-fw me-2" aria-hidden="true"></i>
                        <span>Report</span>
                    </a>
                    <a href="#paper-insights" class="paper-nav-item" data-bs-toggle="tab">
                        <i class="fas fa-chart-bar fa-fw me-2" aria-hidden="true"></i>
                        <span>Insights</span>
                    </a>
                    <a href="#paper-history" class="paper-nav-item" data-bs-toggle="tab">
                        <i class="fas fa-history fa-fw me-2" aria-hidden="true"></i>
                        <span>History</span>
                    </a>
                    <a href="#paper-settings" class="paper-nav-item" data-bs-toggle="tab">
                        <i class="fas fa-cog fa-fw me-2" aria-hidden="true"></i>
                        <span>Settings</span>
                    </a>
                </nav>

                <div class="a4-paper sticky-note">
                    <div class="tab-content mt-5">
                        <div id="paper-report" class="tab-pane fade active show w-100">
                            <!-- <h2 class="text-center">Report</h2> -->
                        </div>
                        <div id="paper-insights" class="tab-pane fade w-100">
                            <div id="kid-chart" class="mt-4"></div>
                        </div>

                        <div id="paper-history" class="tab-pane fade w-100"></div>

                        <div id="paper-settings" class="tab-pane fade w-100">
                            <h3 class="text-center">Settings</h3>
                            <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque
                                laudantium, totam rem aperiam.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer></footer>
</body>

<script>
    function showDatGraph() {
        // var title = {
        //     text: '月平均气温'
        // };
        var title = null;
        // var subtitle = {
        //     text: 'Source: runoob.com'
        // };
        var xAxis = {
            categories: ['一月', '二月', '三月', '四月', '五月', '六月'
                , '七月', '八月', '九月', '十月', '十一月', '十二月']
        };
        var yAxis = {
            // title: {
            //     text: 'Temperature (\xB0C)'
            // },
            title: null,
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        };

        var tooltip = {
            valueSuffix: '\xB0C'
        }

        var legend = {
            layout: 'horizontal',
            align: 'center',
            verticalAlign: 'bottom',
            borderWidth: 0
        };
        var series = [
            {
                name: '已存在的数据',
                data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5], // 已存在的数据
                color: '#7cb5ec' // 已存在的数据的颜色
            },
            {
                name: '预测的数据',
                data: [25.2, 26.5, 23.3, 18.3, 13.9, 9.6], // 预测的数据
                color: '#f7a35c', // 预测的数据的颜色
                // linkedTo: ':previous', // 链接到前一个系列
                // showInLegend: false // 不在图例中显示
            }
        ];
        var json = {};

        json.title = title;
        // json.subtitle = subtitle;
        json.xAxis = xAxis;
        json.yAxis = yAxis;
        json.tooltip = tooltip;
        json.legend = legend;
        json.series = series;
        json.credits = { enabled: false };
        json.chart = {
            backgroundColor: 'transparent', // 设置图表的背景颜色为透明
            height: 300,
        };

        $('#kid-chart').highcharts(json);
    }

    // 这个类用于管理动画，包括动画的执行和停止
    class Animate {
        /**
         * @param {object} config
         * @param {string[]} [config.quene] 动画队列，里面的动画会逐个执行
         *                                  每个动画都是一个字典，包含以下属性：
         *                                  - selector: 选择器，可以是选择器字符串、原生DOM对象或jQuery对象
         *                                  - duration: 动画的持续时间，单位是毫秒
         *                                  - params: 动画的参数，是一个字典，使用CSS属性作为键，使用CSS属性值作为值
         *                                            例如：{ "width": "100px", "height": "100px" }
         *                                  - delay（可选）: 动画的延迟时间，单位是毫秒，当此属性存在时，其他属性可以省略
         *                                  - easing（可选）: 动画的缓动函数
         *                                  例如：{ selector: "#paper-report", duration: 1000, params: { "width": "100px", "height": "100px" } }
         *                                  当子元素是一个数组时，会同时执行数组内的所有动画
         * @param {function} [config.callback] 动画队列执行完毕后的回调函数
         */
        constructor(config) {
            this.quene = config.quene || [];
            this.callback = config.callback || (() => { });

            this.runningAnimation = null;
            this.stopFlag = false;

            this.init = this.init.bind(this);
            this.init();
        }

        async init() {
            for (let animate of this.quene) {
                if (this.stopFlag) {
                    break;
                }

                if (Array.isArray(animate)) {
                    const animationPromises = animate.map(anim => this.doAnimation(anim));
                    this.runningAnimation = await Promise.all(animationPromises);
                } else {
                    this.runningAnimation = await this.doAnimation(animate);
                }
            }

            this.callback();
        }

        /** 执行动画的函数
         * @param {object} animate 动画对象，和构造函数的config.quene数组中的元素相同
         * @returns {promise | null} 如果动画时间不为0，则返回一个promise对象，否则返回null
         */
        doAnimation(animate) {
            const $element = animate.selector instanceof jQuery ? animate.selector : $(animate.selector);
            const duration = animate.duration || 0;
            const params = animate.params;
            const delay = animate.delay || 0;
            const easing = animate.easing || "swing";

            if (delay) {
                return new Promise(resolve => {
                    setTimeout(resolve, delay);
                });
            }

            if (duration === 0) {
                $element.css(params);
                return null;
            }

            const promise = new Promise(resolve => {
                setTimeout(() => {
                    $element.animate(params, {
                        duration,
                        easing,
                        complete: resolve,
                    });
                }, delay);
            });

            return promise;
        }

        stop() {
            this.stopFlag = true;
            if (this.runningAnimation) {
                if (Array.isArray(this.runningAnimation)) {
                    this.runningAnimation.forEach(animation => {
                        if (!animation) {
                            return;
                        }
                        const $element = animation.selector instanceof jQuery ? animation.selector : $(animation.selector);
                        $element.stop();
                    });
                } else {
                    const $element = this.runningAnimation.selector instanceof jQuery ? this.runningAnimation.selector : $(this.runningAnimation.selector);
                    $element.stop();
                }
            }
        }
    }

    // 这个类用于管理工具栏，包括工具栏按钮的显示和隐藏
    class ToolBar {
        /**
         * @param {object} config
         * @param {string} config.toolBar 工具栏的选择器，可以是选择器字符串、原生DOM对象或jQuery对象
         * @param {string[]} [config.needHideToolBtns] 在最开始需要隐藏的工具按钮
         */
        constructor(config) {
            this.config = config;
            this.$toolBar = this.config.toolBar instanceof jQuery ? this.config.toolBar : $(this.config.toolBar);
            this.toolBtns = {
                "previous": {
                    element: this.$toolBar.find("#paper-previous")[0],
                    function: () => { },
                    disable: () => {
                        this.toolBtns.previous.element.classList.add("disabled");
                    },
                    enable: () => {
                        this.toolBtns.previous.element.classList.remove("disabled");
                    },
                },
                "jumpto": {
                    element: this.$toolBar.find("#paper-jumpto")[0],
                    function: () => { },
                    getValue: () => Number(this.toolBtns.jumpto.element.querySelector("input").value),
                    setValue: value => this.toolBtns.jumpto.element.querySelector("input").value = value,
                    setRange: (min, max) => {
                        this.toolBtns.jumpto.element.querySelector("input").setAttribute("min", min);
                        this.toolBtns.jumpto.element.querySelector("input").setAttribute("max", max);
                    },
                    disable: () => {
                        this.toolBtns.jumpto.element.classList.add("disabled");
                    },
                    enable: () => {
                        this.toolBtns.jumpto.element.classList.remove("disabled");
                    },
                },
                "next": {
                    element: this.$toolBar.find("#paper-next")[0],
                    function: () => { },
                    disable: () => {
                        this.toolBtns.next.element.classList.add("disabled");
                    },
                    enable: () => {
                        this.toolBtns.next.element.classList.remove("disabled");
                    },
                },
                "save": {
                    element: this.$toolBar.find("#paper-save")[0],
                    function: () => {
                        console.log("save");
                    },
                    disable: () => {
                        this.toolBtns.save.element.classList.add("disabled");
                    },
                    enable: () => {
                        this.toolBtns.save.element.classList.remove("disabled");
                    },
                },
                "print": {
                    element: this.$toolBar.find("#paper-print")[0],
                    function: () => {
                        console.log("print");
                    },
                    disable: () => {
                        this.toolBtns.print.element.classList.add("disabled");
                    },
                    enable: () => {
                        this.toolBtns.print.element.classList.remove("disabled");
                    },
                },
                "email": {
                    element: this.$toolBar.find("#paper-email")[0],
                    function: () => {
                        console.log("email");
                    },
                    disable: () => {
                        this.toolBtns.email.element.classList.add("disabled");
                    },
                    enable: () => {
                        this.toolBtns.email.element.classList.remove("disabled");
                    },
                },
            };

            this.previousActiveToolBtns = ["previous", "jumpto", "next", "save", "print", "email"];
            // !不能直接赋值this.activeToolBtns = this.previousActiveToolBtns，因为会导致浅拷贝
            this.activeToolBtns = ["previous", "jumpto", "next", "save", "print", "email"];

            this.hideAnimation = null;
            this.showAnimation = null;
            this.init();
        }

        init() {
            // 隐藏不需要的工具按钮
            const needHideToolBtns = this.config.needHideToolBtns || [];
            const toolsNames = Object.keys(this.toolBtns);
            this.previousActiveToolBtns = toolsNames.filter(toolName => !needHideToolBtns.includes(toolName));
            this.activeToolBtns = toolsNames.filter(toolName => !needHideToolBtns.includes(toolName));
            this.getToolBtns(needHideToolBtns).hide();
            // 为工具栏按钮绑定事件
            Object.values(this.toolBtns).forEach(toolBtn => {
                toolBtn.element.addEventListener("click", this.buttonJump);
                toolBtn.element.addEventListener(
                    "click", () => { // 这里必须使用箭头函数，否则this指向会变成window导致出错
                        if (toolBtn.element.classList.contains("disabled")) {
                            return;
                        }
                        this.toolBtns[toolBtn.element.getAttribute("id").replace("paper-", "")].function();
                    });
                // 如果点击的是input，那么阻止事件冒泡
                toolBtn.element.querySelector("input")?.addEventListener("click", event => {
                    event.stopPropagation();
                });
            });
        }

        /**
         * 用于在工具栏按钮被点击后让它跳一下
         * @param {event} event 事件对象
         * @returns {void}
         */
        async buttonJump(event) {
            const $element = $(event.currentTarget);
            if ($element.hasClass("disabled")) {
                return;
            }

            $element.addClass("active");
            await new Promise(resolve => setTimeout(resolve, 150));
            $element.removeClass("active");
        }

        /**
         * 用于获取工具按钮
         * @param {string[]} toolBtnNameArray
         * @returns {JQuery<HTMLElement>} 返回一个jQuery对象
         */
        getToolBtns(toolBtnNameArray) {
            return toolBtnNameArray.reduce(($toolBtns, toolBtnName) => $toolBtns.add(this.toolBtns[toolBtnName].element), $());
        }

        /**
         * 隐藏工具按钮的动画
         * @param {string[]} toolBtnNameArray
         * @returns {void}
         */
        hideToolBtns(toolBtnNameArray) {
            if (toolBtnNameArray.length === 0) {
                return;
            }

            if (this.hideAnimation) {
                this.hideAnimation.stop();
            }
            // if (this.showAnimation) {
            //     this.showAnimation.stop();
            //     this.showAnimation = null;
            // }

            // !以下几种情况可以跳过后面的缩小高度动画
            // 1. （工具栏从一些按钮完全换成另一些按钮，换之前和换之后没有交集），
            //    且更新后的列表（this.activeToolBtns）不为空（工具栏不空）

            const passRestoreHeightAnimation =
                this.activeToolBtns.filter(toolBtnName => this.previousActiveToolBtns.includes(toolBtnName)).length === 0
                && this.previousActiveToolBtns.length !== 0;

            const $toolBtns = this.getToolBtns(toolBtnNameArray);
            $toolBtns
                .css("transition", "none")
                .each(function () {
                    const $this = $(this);
                    $this.attr("data-animate-height", `${$this.outerHeight()}px`);
                    $this.attr("data-animate-margin-top", $this.css("margin-top"));
                    $this.attr("data-animate-margin-bottom", $this.css("margin-bottom"));
                    $this.attr("data-animate-padding-top", $this.css("padding-top"));
                    $this.attr("data-animate-padding-bottom", $this.css("padding-bottom"));
                });

            const moveAnimation = $toolBtns.map((_, element) => {
                const $element = $(element);
                return {
                    selector: $element,
                    duration: 300,
                    params: {
                        transform: "translateX(160px)",
                    },
                };
            }).get();
            const hideAnimation = $toolBtns.map((_, element) => {
                const $element = $(element);
                return {
                    selector: $element,
                    duration: passRestoreHeightAnimation ? 0 : 300,
                    params: {
                        height: 0,
                        "margin-top": 0,
                        "margin-bottom": 0,
                        "padding-top": 0,
                        "padding-bottom": 0,
                    },
                };
            }).get();

            this.hideAnimation = new Animate({
                quene: [
                    moveAnimation,
                    hideAnimation,
                ],
                callback: () => {
                    $toolBtns.hide();
                    this.hideAnimation = null;
                },
            });
        }

        /**
         * 显示工具按钮的动画
         * @param {string[]} toolBtnNameArray
         * @returns {void}
         */
        showToolBtns(toolBtnNameArray) {
            if (toolBtnNameArray.length === 0) {
                return;
            }

            const $toolBtns = this.getToolBtns(toolBtnNameArray);
            // $toolBtns.show();

            // if (this.hideAnimation) {
            //     this.hideAnimation.stop();
            //     this.hideAnimation = null;
            // }
            if (this.showAnimation) {
                this.showAnimation.stop();
            }

            // !以下几种情况可以跳过前面的恢复高度动画，直接执行移动动画
            // 1. 当前活跃的按钮列表为空（工具栏空了）
            // 2. 隐藏动画执行完成后的工具栏为空（这个条件需要在启动前额外等待300ms）
            // 3. 工具栏不为空，但是需要展示的按钮均位于工具栏的最后且连续

            // 判断需要展示的按钮是否位于按钮列表的最后且连续
            // 例如，当前按钮列表为["previous", "jumpto", "next", "save", "print", "email"]
            // 需要展示的按钮列表为["save", "print", "email"]
            // 那么它们符合条件
            // 如果需要展示的按钮列表为["next", "print", "email"]
            // 那么它们不符合条件
            // 如果需要展示的按钮列表为["previous", "jumpto", "next"]，仍然不符合条件，因为它们结尾的按钮不是最后一个按钮
            const isContinuousAtEnd = toolBtnNameArray.every((toolBtnName, index) => {
                const toolBtnKeys = Object.keys(this.toolBtns);
                const offsetIndex = toolBtnKeys.length - toolBtnNameArray.length + index;
                const targetToolBtnName = toolBtnKeys[offsetIndex];

                return toolBtnName === targetToolBtnName;
            });
            // 判断当前活跃的按钮列表是否为空
            const isActiveToolBtnsEmpty = this.previousActiveToolBtns.length === 0;

            // 判断隐藏动画执行完成后的工具栏是否为空，
            // 判断方法为：this.activeToolBtns 和 this.previousActiveToolBtns 的交集是否为空
            const isHideToolBtnsEmpty = this.activeToolBtns.filter(toolBtnName => this.previousActiveToolBtns.includes(toolBtnName)).length === 0;

            // 判断是否需要跳过恢复高度动画
            const skipRestoreHeightAnimation = isContinuousAtEnd || isActiveToolBtnsEmpty || isHideToolBtnsEmpty;

            const showBtnAnimation = $toolBtns.map((_, element) => {
                const $element = $(element);
                return {
                    selector: $element,
                    duration: skipRestoreHeightAnimation ? 0 : 300,
                    params: {
                        height: $element.attr("data-animate-height"),
                        "margin-top": $element.attr("data-animate-margin-top"),
                        "margin-bottom": $element.attr("data-animate-margin-bottom"),
                        "padding-top": $element.attr("data-animate-padding-top"),
                        "padding-bottom": $element.attr("data-animate-padding-bottom"),
                    },
                };
            }).get();

            const moveAnimation = {
                selector: $toolBtns,
                duration: 300,
                params: {
                    transform: "translateX(0px)",
                },
            }

            const animationQuene = [
                {
                    selector: $toolBtns,
                    duration: 0,
                    params: {
                        display: "block",
                    },
                },
                showBtnAnimation,
                moveAnimation
            ];

            // 如果隐藏动画执行完成后的工具栏为空（工具栏从一些按钮完全换成另一些按钮，换之前和换之后没有交集），
            // 且之前不为空（也就是说，工具栏不能刚刚从空变成不空）
            if (isHideToolBtnsEmpty && !isActiveToolBtnsEmpty) {
                animationQuene.unshift({
                    delay: 300,
                });
            }

            this.showAnimation = new Animate({
                quene: animationQuene,
                callback: () => {
                    $toolBtns.removeAttr("style");
                    $toolBtns.removeAttr("data-animate-height data-animate-margin-top data-animate-margin-bottom data-animate-padding-top data-animate-padding-bottom");
                    this.showAnimation = null;
                },
            });
        }

        /**
         * 更新任务栏
         * @param {string[]} toolBtnNameArray
         * @returns {void}
         */
        updateToolBarButtons(toolBtnNameArray) {
            this.previousActiveToolBtns = Array.from(this.activeToolBtns); // 深拷贝
            this.activeToolBtns = toolBtnNameArray;
            const hideToolBtns = this.previousActiveToolBtns.filter(toolBtnName => !this.activeToolBtns.includes(toolBtnName));
            const showToolBtns = this.activeToolBtns.filter(toolBtnName => !this.previousActiveToolBtns.includes(toolBtnName));
            // console.log(this.previousActiveToolBtns, this.activeToolBtns);
            this.hideToolBtns(hideToolBtns);
            this.showToolBtns(showToolBtns);
        }

        /**
         * 更新工具栏的功能，在切换了页面之后需要调用此函数以调整分页按钮的功能
         * @param {object} functions
         * @returns {void}
         */
        updateToolBarFunctions(functions) {
            Object.keys(functions).forEach(toolName => {
                this.toolBtns[toolName].function = functions[toolName];
            });
        }
    }

    // 这个类用于管理分页的内容，包括切换页面、跳转页面、存储不同页面内容等
    class Pagination {
        /**
         * @param {object} config 设置分页的配置
         * @param {string} config.element 分页的选择器，可以是jQuery对象，也可以是选择器字符串，还可以是原生的DOM对象
         * @param {string[]} [config.contents] 每一页的内容，是一个数组，数组的每一项都是一个字符串，每个字符串都是HTML代码
         * @param {number} [config.page] (可选)当前页码，默认为1
         * @param {number} [config.totalPage] (可选)总页数，默认为contents的长度
         * @param {function[]} [config.onDisplay] (可选)每一页显示时的回调函数，是一个数组，数组的每一项都是一个函数，如果当前页没有回调函数，则使用null占位
         */

        constructor(config) {
            this.$element = config.element instanceof jQuery ? config.element : $(config.element);
            this.contents = config.contents || [];
            this.page = config.page || 1;
            this.totalPage = config.totalPage || this.contents.length;
            // 没有参数的话就是totalPage个null组成的数组，例如：[null, null, null, null, null]
            this.onDisplay = config.onDisplay || Array.from({ length: this.totalPage }, () => null);
        }

        /**
         * 切换到指定页
         * @param {number} page 要切换到的页码
         * @param {boolean} [animation=true] 是否使用动画，默认为true
         * @returns {void}
         */
        async changePage(page, animation = true) {
            const html = this.contents[page - 1];

            const pageOnDisplay = this.onDisplay[page - 1] || (() => { });

            if (!animation) {
                this.$element.html(html);
                pageOnDisplay();
                return;
            }

            this.$element.css("opacity", 0);

            // 使用 Promise 替换 setTimeout
            await new Promise(resolve => setTimeout(resolve, 150));

            // 把对应的文字按照换行符分割成数组，然后遍历数组，把每一行文字用p标签包裹起来
            this.$element.html(html);
            pageOnDisplay();
            this.$element.css("opacity", 1);
        }

        /** 
         * 下一页
         * @returns {void}
         */
        nextPage() {
            if (this.page === this.totalPage) {
                return;
            }
            this.page++;
            this.changePage(this.page);
        }

        /** 
         * 上一页
         * @returns {void}
         */
        previousPage() {
            if (this.page === 1) {
                return;
            }
            this.page--;
            this.changePage(this.page);
        }

        /** 
         * 跳转到指定页
         * @param {number} page 要跳转到的页码
         * @returns {void}
         */
        jumpToPage(page) {
            if (page < 1 || page > this.totalPage || page === this.page) {
                return;
            }
            this.page = page;
            this.changePage(this.page);
        }
    }

    // 这个类用于管理板夹上的整个页面，包括页面的切换、工具栏的更新、分页器的更新等
    class Paper {
        /**
         * @param {object} config
         * @param {string} config.sectionBar 侧边栏的选择器，可以是jQuery对象，也可以是选择器字符串，还可以是原生的DOM对象
         */
        constructor(config) {
            const $sectionBar = config.sectionBar instanceof jQuery ? config.sectionBar : $(config.sectionBar);
            this.$sectionBar = $sectionBar;
            // 页面
            this.pages = [
                {
                    id: "paper-report",
                    name: "Report",
                    toolBar: ["previous", "jumpto", "next", "save", "print", "email"],
                    pagination: new Pagination({
                        element: "#paper-report",
                        page: 1,
                        // totalPage: 5,
                        contents: texts,
                    }),
                },
                {
                    id: "paper-insights",
                    name: "Insights",
                    toolBar: ["save", "print", "email"],
                    pagination: new Pagination({
                        element: "#paper-insights",
                        page: 1,
                        onDisplay: [
                            showDatGraph,
                        ],
                        // totalPage: 5,
                        contents: charts,
                    }),
                },
                {
                    id: "paper-history",
                    name: "History",
                    toolBar: ["previous", "jumpto", "next"],
                    pagination: new Pagination({
                        element: "#paper-history",
                        page: 1,
                        // totalPage: 5,
                        contents: results,
                    }),
                },
                {
                    id: "paper-settings",
                    name: "Settings",
                    toolBar: [],
                    pagination: new Pagination({
                        element: "#paper-settings",
                        page: 1,
                        // totalPage: 5,
                        contents: texts,
                    }),
                }
            ];

            this.toolBar = new ToolBar({
                toolBar: "#tool-bar",
                initialToolBtns: this.pages[0].toolBar,
            });

            this.init = this.init.bind(this);
            this.handleTabOnShow = this.handleTabOnShow.bind(this);
            this.init();
        }

        /**
         * 初始化函数
         * @returns {void}
         */
        init() {
            // 监听bootstrap的tab事件
            this.$sectionBar
                .find('a[data-bs-toggle="tab"]')
                .on('shown.bs.tab', this.handleTabOnShow);
            //加载第一个页面
            this.handleTabOnShow({ target: this.$sectionBar.find('a[data-bs-toggle="tab"]')[0] });
        }

        /**
         * 在切换页面时调用的函数，负责更新工具栏和分页器按钮绑定的函数
         * @param {event} event 事件对象
         * @returns {void}
         */
        handleTabOnShow(event) {
            const $target = $(event.target); // newly activated tab
            const $previous = $(event.relatedTarget); // previous active tab
            const targetId = $target.attr("href").slice(1);
            // const previousId = $previous.attr("href").slice(1);
            const targetPage = this.pages.find(page => page.id === targetId);
            // const previousPage = this.pages.find(page => page.id === previousId);
            // 显示这个页面，填充内容
            targetPage.pagination.changePage(targetPage.pagination.page, false);
            this.toolBar.updateToolBarButtons(targetPage.toolBar);
            this.pagination = targetPage.pagination;

            if (this.pagination.page === 1) {
                this.toolBar.toolBtns.previous.disable();
                this.toolBar.toolBtns.next.enable();
            } else if (this.pagination.page === this.pagination.totalPage) {
                this.toolBar.toolBtns.previous.enable();
                this.toolBar.toolBtns.next.disable();
            } else {
                this.toolBar.toolBtns.previous.enable();
                this.toolBar.toolBtns.next.enable();
            }
            this.toolBar.toolBtns.jumpto.setValue(this.pagination.page);
            this.toolBar.toolBtns.jumpto.setRange(1, this.pagination.totalPage);

            this.toolBar.updateToolBarFunctions({
                previous: () => {
                    if (this.pagination.page === 1) {
                        return;
                    }
                    this.pagination.previousPage();
                    this.toolBar.toolBtns.jumpto.setValue(this.pagination.page);
                    this.toolBar.toolBtns.next.enable();
                    if (this.pagination.page === 1) {
                        this.toolBar.toolBtns.previous.disable();
                    }

                    // this.pagination.previousPage();
                    // console.log("previous");
                },
                jumpto: () => {
                    this.pagination.jumpToPage(this.toolBar.toolBtns.jumpto.getValue());
                    if (this.pagination.page === 1) {
                        this.toolBar.toolBtns.previous.disable();
                        this.toolBar.toolBtns.next.enable();
                    } else if (this.pagination.page === this.pagination.totalPage) {
                        this.toolBar.toolBtns.next.disable();
                        this.toolBar.toolBtns.previous.enable();
                    } else {
                        this.toolBar.toolBtns.previous.enable();
                        this.toolBar.toolBtns.next.enable();
                    }
                },
                next: () => {
                    if (this.pagination.page === this.pagination.totalPage) {
                        return;
                    }
                    this.pagination.nextPage();
                    this.toolBar.toolBtns.jumpto.setValue(this.pagination.page);
                    this.toolBar.toolBtns.previous.enable();
                    if (this.pagination.page === this.pagination.totalPage) {
                        this.toolBar.toolBtns.next.disable();
                    }
                }
            });
            // if (targetPage.pagination) {
            //     // console.log("pagination");
            //     this.pagination = new Pagination({
            //         element: `#${targetId} div`,
            //         page: 1,
            //         totalPage: 5,
            //         contents: texts,
            //     });
            //     this.toolBar.updateToolBarButtons(targetPage.toolBar);
            //     this.toolBar.updateToolBarFunctions({
            //         previous: () => {
            //             if (this.pagination.page === 1) {
            //                 return;
            //             }
            //             this.pagination.previousPage();
            //             this.toolBar.toolBtns.next.enable();
            //             if (this.pagination.page === 1) {
            //                 this.toolBar.toolBtns.previous.disable();
            //             }

            //             // this.pagination.previousPage();
            //             // console.log("previous");
            //         },
            //         jumpto: () => {
            //             this.pagination.jumpToPage(this.toolBar.toolBtns.jumpto.getValue());
            //         },
            //         next: () => {
            //             if (this.pagination.page === this.pagination.totalPage) {
            //                 return;
            //             }
            //             this.pagination.nextPage();
            //             this.toolBar.toolBtns.previous.enable();
            //             console.log(this.pagination.page, this.pagination.totalPage);
            //             console.log(this.pagination.page === this.pagination.totalPage);
            //             if (this.pagination.page === this.pagination.totalPage) {
            //                 this.toolBar.toolBtns.next.disable();
            //                 console.log(this.toolBar.toolBtns.next);
            //             }
            //         }
            //     });
            //     // console.log(this.toolBar.toolBtns.next.function());
            //     // console.log(this.toolBar.toolBtns.next.function);
            //     // console.log(this.toolBar.toolBtns.next.function());
            // }
        }
    }

    const paper = new Paper({
        sectionBar: "#section-bar",
    });

</script>

</html>